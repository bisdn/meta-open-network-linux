Upstream-Status: Inappropriate [Hack for building with yocto]

From ae45c22f92901b54ae817fd8bcf2f5bae3d5c205 Mon Sep 17 00:00:00 2001
From: Jonas Gorski <jonas.gorski@bisdn.de>
Date: Wed, 18 May 2022 15:49:13 +0200
Subject: [PATCH 2/3] onlpm: add an argument for just printing the builddirs

To allow building without packaging, we need to know the appropriate
build dir for passing to make.

Add an argument to onlpm that allows printing the appropriate build
directories of packages.

Signed-off-by: Jonas Gorski <jonas.gorski@bisdn.de>
---
 tools/onlpm.py | 10 ++++++++++
 1 file changed, 10 insertions(+)

diff --git a/tools/onlpm.py b/tools/onlpm.py
index b5a7792695ab..0c9a9338272e 100755
--- a/tools/onlpm.py
+++ b/tools/onlpm.py
@@ -1305,6 +1305,7 @@ if __name__ == '__main__':
     ap.add_argument("--in-repo", nargs='+', metavar='PACKAGE')
     ap.add_argument("--include-env-json", default=os.environ.get('ONLPM_OPTION_INCLUDE_ENV_JSON', None))
     ap.add_argument("--platform-manifest", metavar=('PACKAGE'))
+    ap.add_argument("--show-build-dirs", nargs='+', metavar='PACKAGE')
 
     ops = ap.parse_args()
 
@@ -1423,6 +1424,15 @@ if __name__ == '__main__':
                 else:
                     raise OnlPackageMissingError(p)
 
+        if ops.show_build_dirs:
+            for p in ops.show_build_dirs:
+                if p in pm:
+                    for pg in pm.filtered_package_groups():
+                        if p in pg:
+                            print(pg._pkgs['__directory'])
+                else:
+                    raise OnlPackageMissingError(p)
+
         if ops.require:
             for p in ops.require:
                 pm.require(p, force=ops.force, build_missing=not ops.no_build_missing,
-- 
2.36.1

